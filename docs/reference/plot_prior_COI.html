<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Plot prior on COI — plot_prior_COI • MALECOT</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Plot prior on COI — plot_prior_COI" />

<meta property="og:description" content="Produce plot of the prior on COI for given parameters. Options
  include the uniform distribution, and a modified form of Poisson and
  negative binomial distribution (see details)." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALECOT</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/tutorial-biallelic.html">Tutorial 1: bi-allelic data</a>
    </li>
    <li>
      <a href="../articles/complex-priors.html">Tutorial 2: more realistic models</a>
    </li>
    <li>
      <a href="../articles/multiallelic-data.html">Tutorial 3: multi-allelic data</a>
    </li>
    <li>
      <a href="../articles/comparing-models.html">Tutorial 4: comparing models (estimating K)</a>
    </li>
    <li>
      <a href="../articles/running-in-parallel.html">Tutorial 5: running in parallel</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/ensuring-good-mixing.html">Ensuring good mixing</a>
    </li>
    <li>
      <a href="../articles/power-analysis-within-model.html">Power analysis - within model</a>
    </li>
    <li>
      <a href="../articles/power-analysis-between-models.html">Power analysis - between models</a>
    </li>
    <li>
      <a href="../articles/gti-mathematical-details.html">GTI mathematical details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bobverity/malecot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Plot prior on COI</h1>
    
    <div class="hidden name"><code>plot_prior_COI.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Produce plot of the prior on COI for given parameters. Options
  include the uniform distribution, and a modified form of Poisson and
  negative binomial distribution (see details).</p>
    
    </div>

    <pre class="usage"><span class='fu'>plot_prior_COI</span>(<span class='kw'>COI_model</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>, <span class='kw'>COI_mean</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>COI_dispersion</span> <span class='kw'>=</span> <span class='fl'>2</span>,
  <span class='kw'>COI_max</span> <span class='kw'>=</span> <span class='fl'>20</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>COI_model</th>
      <td><p>the type of prior on COI. Must be one of "uniform", 
"poisson", or "nb" (negative binomial)</p></td>
    </tr>
    <tr>
      <th>COI_mean</th>
      <td><p>the prior mean (before truncating at <code>COI_max</code>). Note 
that this parameter only applies under the "poisson" and "nb" models</p></td>
    </tr>
    <tr>
      <th>COI_dispersion</th>
      <td><p>the ratio of the variance to the mean of the prior on
COI. Only applies under the negative binomial model. Must be &gt;1</p></td>
    </tr>
    <tr>
      <th>COI_max</th>
      <td><p>the maximum COI allowed. Distributions are truncated at this
value</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The prior on COI can be uniform, Poisson, or negative binomial. In 
  the uniform case there is an equal chance of any given sample having a COI 
  between 1 and <code>COI_max</code> (inclusive). In the Poisson and negative 
  binomial cases it is important to note that the distribution is over 
  (COI-1), rather than over COI. This is because both Poisson and negative 
  binomial distributions allow for 0 values, which cannot be the case here 
  because observed samples must contain at least 1 genotype. Poisson and
  negative binomial distributions are also truncated at <code>COI_max</code>.</p>
<p>The full probability mass distribution for the Poisson case with 
  <code>COI_mean</code>\( = \mu\) and <code>COI_max</code>\( = M\) can be written
  $$ Pr(COI = n) = z (\mu-1)^(n-1) exp(-(\mu-1)) / (n-1)! $$ where \(z\)
  is a normalising constant that ensures the distribution sums to unity, and
  is defined as: $$1/z = \sum_{i=1}^M (\mu-1)^(i-1) exp(-(\mu-1)) /
  (i-1)! $$</p>
<p>The mean of this distribution will generally be very close to \(\mu\),
  and the variance will be close to \(\mu-1\) (strictly it will approach
  these values as \(M\) tends to infinity).</p>
<p>The full probability mass distribution for the negative binomial case with 
  <code>COI_mean</code>\( = \mu\), <code>COI_dispersion</code>\( = v/\mu\) and 
  <code>COI_max</code>\( = M\) can be written $$ Pr(COI = n) = z 
  \Gamma(n-1+N)/( \Gamma(N)(n-1)! ) p^N (1-p)^(n-1) $$ where \(N =
  (\mu-1)^2/(v-\mu+1)\), \(p = (\mu-1)/v\), and \(z\) is a normalising 
  constant that ensures the distribution sums to unity, and is defined as: 
  $$1/z = \sum_{i=1}^M \Gamma(i-1+N)/( \Gamma(N)(i-1)! ) p^N (1-p)^(i-1) 
  $$</p>
<p>The mean of this distribution will generally be very close to \(\mu\) and
  the variance will be close to \(v\) (strictly it will approach these 
  values as \(M\) tends to infinity).</p>
    

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
          </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

