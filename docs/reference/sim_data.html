<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate genetic data — sim_data • MALECOT</title>

<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulate genetic data — sim_data" />

<meta property="og:description" content="Simulate genetic data from the same model used in the MALECOT inference step." />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALECOT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/tutorial-biallelic.html">Tutorial 1: bi-allelic data</a>
    </li>
    <li>
      <a href="../articles/complex-priors.html">Tutorial 2: more realistic models</a>
    </li>
    <li>
      <a href="../articles/multiallelic-data.html">Tutorial 3: multi-allelic data</a>
    </li>
    <li>
      <a href="../articles/comparing-models.html">Tutorial 4: comparing models (estimating K)</a>
    </li>
    <li>
      <a href="../articles/running-in-parallel.html">Tutorial 5: running in parallel</a>
    </li>
    <li class="divider"></li>
    <li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/ensuring-good-mixing.html">Ensuring good mixing</a>
    </li>
    <li>
      <a href="../articles/power-analysis-within-model.html">Power analysis - within model</a>
    </li>
    <li>
      <a href="../articles/power-analysis-between-models.html">Power analysis - between models</a>
    </li>
    <li>
      <a href="../articles/gti-mathematical-details.html">GTI mathematical details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/bobverity/malecot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate genetic data</h1>
    
    <div class="hidden name"><code>sim_data.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Simulate genetic data from the same model used in the MALECOT inference step.</p>
    
    </div>

    <pre class="usage"><span class='fu'>sim_data</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>24</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>data_format</span> <span class='kw'>=</span> <span class='st'>"biallelic"</span>,
  <span class='kw'>pop_col_on</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='kw'>alleles</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>,
  <span class='kw'>COI_model</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>, <span class='kw'>COI_max</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>COI_manual</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/rep'>rep</a></span>(-<span class='fl'>1</span>, <span class='no'>n</span>),
  <span class='kw'>COI_mean</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>COI_dispersion</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>e1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>e2</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>prop_missing</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>the number of samples</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>the number of loci per sample</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>the number of subpopulations</p></td>
    </tr>
    <tr>
      <th>data_format</th>
      <td><p>whether to produce data in "biallelic" or "multiallelic"
format. Note that if biallelic format is chosen then <code>alleles</code> is
always set to 2</p></td>
    </tr>
    <tr>
      <th>pop_col_on</th>
      <td><p>TODO</p></td>
    </tr>
    <tr>
      <th>alleles</th>
      <td><p>the number of alleles at each locus. Can be a vector of length
<code>L</code> specifying the number of alleles at each locus, or a single scalar
value specifying the number of alleles at all loci</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>the shape parameter(s) of the prior on allele frequencies. This
prior is Beta in the bi-allelic case, and Dirichlet in the multi-allelic 
case. <code>lambda</code> can be:</p><ul>
<li><p>a single scalar value, in which case the same value is used for 
  every allele and every locus (i.e. the prior is symmetric)</p></li>
<li><p>a vector of values, in which case the same vector is used for every
  locus. Only works if the same number of alleles applies at every locus</p></li>
<li><p>a list of vectors specifying the shape parameter separately for
  each allele of each locus. The list must of length <code>L</code>, and must
  contain vectors of length equal to the number of alleles at that locus</p></li>
</ul></td>
    </tr>
    <tr>
      <th>COI_model</th>
      <td><p>the distribution from which COIs are drawn. Options include
a uniform distribution (<code>"uniform"</code>), a Poisson distribution
(<code>"poisson"</code>), or a negative binomial distribution (<code>"nb"</code>)</p></td>
    </tr>
    <tr>
      <th>COI_max</th>
      <td><p>the maximum allowed COI. Any COIs that are initially drawn
larger than this value are set down to this value</p></td>
    </tr>
    <tr>
      <th>COI_manual</th>
      <td><p>option to override the MCMC and set the COI of one or more
samples manually, in which case they are not updated. Vector of length
<code>n</code> specifing the integer valued COI of each sample, with -1
indicating that a sample should be estimated</p></td>
    </tr>
    <tr>
      <th>COI_mean</th>
      <td><p>the mean of the distribution from which COIs are drawn. Only
applies under the Poisson and negative binomial models (under the uniform
model the mean is <code>(COI_max+1)/2</code> by definition)</p></td>
    </tr>
    <tr>
      <th>COI_dispersion</th>
      <td><p>Only used under the negative binomial model. Defines
how much larger the variance is than the mean. Must be &gt; 1</p></td>
    </tr>
    <tr>
      <th>e1</th>
      <td><p>the probability of a true homozygote being incorrectly called as a
heterozygote</p></td>
    </tr>
    <tr>
      <th>e2</th>
      <td><p>the probability of a true heterozygote being incorrectly called as a
homozygote</p></td>
    </tr>
    <tr>
      <th>prop_missing</th>
      <td><p>the proportion of the data that is missing. Note that
data are masked out at random, meaning in some rare cases (and when the
proportion of missing data is large) an entire sample or locus can end up
being masked out, which will throw an error when loaded into a project</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>TODO</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'># TODO
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

