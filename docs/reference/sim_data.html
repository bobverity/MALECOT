<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Simulate genetic data — sim_data • MALECOT</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Simulate genetic data — sim_data" />

<meta property="og:description" content="Generates simulated data in the format accepted by MALECOT.
  Simulated data can be either bi-allelic or multi-allelic. In addition to
  returning the simulated data set, this function returns intermediate
  outputs used in data generation, including the true complexity of infection
  and true subpopulation membership of all samples. These additional outputs
  will not generally be present in real-world data sets, but can be useful in
  assessing the accuracy of the MCMC inference step by "truthing" estimated
  values (this is one of the major advantages of using simulated data)." />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALECOT</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Simulate genetic data</h1>
    
    <div class="hidden name"><code>sim_data.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>Generates simulated data in the format accepted by MALECOT.
  Simulated data can be either bi-allelic or multi-allelic. In addition to
  returning the simulated data set, this function returns intermediate
  outputs used in data generation, including the true complexity of infection
  and true subpopulation membership of all samples. These additional outputs
  will not generally be present in real-world data sets, but can be useful in
  assessing the accuracy of the MCMC inference step by "truthing" estimated
  values (this is one of the major advantages of using simulated data).</p>
    
    </div>

    <pre class="usage"><span class='fu'>sim_data</span>(<span class='kw'>n</span> <span class='kw'>=</span> <span class='fl'>100</span>, <span class='kw'>L</span> <span class='kw'>=</span> <span class='fl'>24</span>, <span class='kw'>K</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>data_format</span> <span class='kw'>=</span> <span class='st'>"biallelic"</span>,
  <span class='kw'>alleles</span> <span class='kw'>=</span> <span class='fl'>2</span>, <span class='kw'>lambda</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>COI_model</span> <span class='kw'>=</span> <span class='st'>"poisson"</span>, <span class='kw'>COI_manual</span> <span class='kw'>=</span> <span class='kw'>NULL</span>,
  <span class='kw'>COI_max</span> <span class='kw'>=</span> <span class='fl'>20</span>, <span class='kw'>COI_mean</span> <span class='kw'>=</span> <span class='fl'>3</span>, <span class='kw'>COI_dispersion</span> <span class='kw'>=</span> <span class='fl'>1</span>, <span class='kw'>e1</span> <span class='kw'>=</span> <span class='fl'>0</span>, <span class='kw'>e2</span> <span class='kw'>=</span> <span class='fl'>0</span>,
  <span class='kw'>prop_missing</span> <span class='kw'>=</span> <span class='fl'>0</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>n</th>
      <td><p>number of samples</p></td>
    </tr>
    <tr>
      <th>L</th>
      <td><p>number of loci</p></td>
    </tr>
    <tr>
      <th>K</th>
      <td><p>number of subpopulations. Samples are drawn with equal probability
from each of these subpopulations</p></td>
    </tr>
    <tr>
      <th>data_format</th>
      <td><p>character string indicating whether data should be
<code>"biallelic"</code> or <code>"multiallelic"</code>. In the bi-allelic case data
are formatted similar to The Real McCOIL (Chang et al. 2017). In the
multi-allelic case data are in long format, allowing a different number of
haplotypes per sample</p></td>
    </tr>
    <tr>
      <th>alleles</th>
      <td><p>vector of length <code>L</code> indicating the number of possible
alleles at each locus, or if a single value is used then the same value
applies for all loci. In the bi-allelic case this parameter is ignored as
the number of alleles is fixed at 2</p></td>
    </tr>
    <tr>
      <th>lambda</th>
      <td><p>shape parameter(s) governing the prior on allele frequencies. 
This prior is a Beta distribution for the bi-allelic case or a Dirichlet 
distribution for the multi-allelic case. In the simplest case,
<code>lambda</code> can be a single scalar value, in which case the same shape
paremeter will be used for all loci and all alleles (i.e. a symmetric Beta
or Dirichlet prior). In the more general case <code>lambda</code> can be a list
of length <code>L</code>, containing vectors of length equal to the number of
alleles at each locus, allowing different shape parameters to be defined
for each allele individually</p></td>
    </tr>
    <tr>
      <th>COI_model</th>
      <td><p>the type of prior distribution on COI in each subpopulation.
Can be <code>uniform</code>, <code>poisson</code> or <code>nb</code> (negative binomial).
Note that the poisson and negative binomial distributions use a
non-standard parametrization to account for the fact that COI=0 is not
possible (see Details). If <code>COI_manual</code> is used then this prior is
ignored.</p></td>
    </tr>
    <tr>
      <th>COI_manual</th>
      <td><p>manually define COI of all samples</p></td>
    </tr>
    <tr>
      <th>COI_max</th>
      <td><p>the maximum possible COI in any individual, irrespective of
the type of prior on COI</p></td>
    </tr>
    <tr>
      <th>COI_mean</th>
      <td><p>the mean COI in a given subpopulation (applies to
<code>poisson</code> and <code>nb</code> priors only). If vector valued then should be
of length <code>K</code> and defines the mean separately for each subpopulation.
If scalar valued then the same value applies to all subpopulations. Note
that this mean value will only be correct when <code>COI_max</code> is
sufficiently large (see Details)</p></td>
    </tr>
    <tr>
      <th>COI_dispersion</th>
      <td><p>the index of dispersion (i.e. the variance over the
mean) of the prior on COI. Applies to <code>nb</code> prior only - in the Poisson
case the dispersion is fully defined by the <code>COI_mean</code>. If vector
valued then should be of length <code>K</code> and defines the dispersion
separately for each subpopulation. If scalar valued then the same value
applies to all subpopulations. Note that this dispersion will only be
correct when <code>COI_max</code> is sufficiently large (see Details)</p></td>
    </tr>
    <tr>
      <th>e1</th>
      <td><p>first error term: the probabilty of a true homozygous locus being
mis-called as a heterozygote. Errors are only allowed under the
<code>biallelic</code> model</p></td>
    </tr>
    <tr>
      <th>e2</th>
      <td><p>second error term: the probabilty of a true heterozygous locus
being mis-called as a homozygote. Errors are only allowed under the
<code>biallelic</code> model</p></td>
    </tr>
    <tr>
      <th>prop_missing</th>
      <td><p>the proportion of missing data. Missing data is randomly
distributed between samples and loci, and is coded as <code>-1</code></p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>sim_data()</code> function returns a list containing multiple
  elements The main output is the element <code>data</code>, which is the final
  simulated data set, along with the number of samples (<code>n</code>) and the
  number of loci (<code>L</code>). If the parameters <code>e1</code> or <code>e2</code> are
  non-zero, or if <code>prop_missing</code> is greater than zero, then an
  uncorrupted version of the data is also returned in the element
  <code>data_uncorrupted</code>. This object represents what the true underlying
  data looked like before errors and missing data were introduced. Other
  "truthing" elements include the true subpopulation grouping, true COI, and
  true allele frequencies that were simulated to produce the final data. The
  accuracy of MCMC-based inference can be assessed by comparing posterior
  estimates against these "true" values used in simulation. Finally, the
  original call to the function is also stored in the element <code>call</code> for
  the sake of producing a complete record of all simulation parameters used.</p>
<p>The prior on COI can be uniform, Poisson, or negative binomial. In the
  uniform case there is an equal chance of any given sample having a COI
  between 1 and <code>COI_max</code> (inclusive). In the Poisson and negative
  binomial cases it is important to note that the distribution is over
  (COI-1), rather than over COI. This is because both Poisson and negative
  binomial distributions allow for 0 values, which cannot be the case here
  because observed samples must contain at least 1 genotype.</p>
<p>The full probability mass distribution for the Poisson case with
  <code>COI_mean</code>\(=\mu\) and <code>COI_max</code>\(=M\) can be written $$
  Pr(COI=n) = z (\mu-1)^(n-1) exp(-(\mu-1)) / (n-1)! $$ where z is a
  normalising constant that ensures the distribution sums to unity: $$1/z
  = \sum_{i=1}^M (\mu-1)^(i-1) exp(-(\mu-1)) / (i-1)! $$</p>
<p>The mean of this distribution will generally be very close to \(\mu\),
  and the variance will be close to \(\mu-1\) (strictly it will approach
  these values as \(M\) tends to infinity).</p>
<p>The full probability mass distribution for the negative binomial case with
  <code>COI_mean</code>\(=\mu\), <code>COI_dispersion</code>\(=v/\mu\) and
  <code>COI_max</code>\(=M\) can be written $$ Pr(COI=n) = z \Gamma(n-1+N)/(
  \Gamma(N)(n-1)! ) p^N (1-p)^(n-1) $$ where \(N=(\mu-1)^2/(v-\mu+1)\),
  \(p=(\mu-1)/v\), and z is a normalising constant that ensures the
  distribution sums to unity: $$1/z = \sum_{i=1}^M \Gamma(i-1+N)/(
  \Gamma(N)(i-1)! ) p^N (1-p)^(i-1) $$</p>
<p>The mean of this distribution will generally be very close to \(\mu\),
  and the variance will be close to \(v\) (strictly it will approach these
  values as \(M\) tends to infinity).</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Chang, H.H., Worby, C.J., Yeka, A., Nankabirwa, J., Kamya, M.R.,
Staedke, S.G., Dorsey, G., Murphy, M., Neafsey, D.E., Jeffreys, A.E. and
Hubbart, C., 2017. THE REAL McCOIL: A method for the concurrent estimation of
the complexity of infection and SNP allele frequency for malaria parasites.
PLoS computational biology, 13(1), p.e1005348.</p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'># TODO
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#details">Details</a></li>

      <li><a href="#references">References</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

