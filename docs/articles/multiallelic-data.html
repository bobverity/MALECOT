<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Multi-allelic data • MALECOT</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Multi-allelic data">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALECOT</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Vignettes
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/installation.html">Installation</a>
    </li>
    <li>
      <a href="../articles/tutorial-biallelic.html">Tutorial 1: bi-allelic data</a>
    </li>
    <li>
      <a href="../articles/complex-priors.html">Tutorial 2: more realistic models</a>
    </li>
    <li>
      <a href="../articles/multiallelic-data.html">Tutorial 3: multi-allelic data</a>
    </li>
    <li>
      <a href="../articles/comparing-models.html">Tutorial 4: comparing models (estimating K)</a>
    </li>
    <li>
      <a href="../articles/running-in-parallel.html">Tutorial 5: running in parallel</a>
    </li>
    <li class="divider">
    <li class="dropdown-header">Advanced topics</li>
    <li>
      <a href="../articles/ensuring-good-mixing.html">Ensuring good mixing</a>
    </li>
    <li>
      <a href="../articles/power-analysis-within-model.html">Power analysis - within model</a>
    </li>
    <li>
      <a href="../articles/power-analysis-between-models.html">Power analysis - between models</a>
    </li>
    <li>
      <a href="../articles/gti-mathematical-details.html">GTI mathematical details</a>
    </li>
  </ul>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bobverity/malecot">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Multi-allelic data</h1>
                        <h4 class="author">Bob Verity</h4>
            
            <h4 class="date">2019-02-25</h4>
      
      
      <div class="hidden name"><code>multiallelic-data.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates the MALECOT analysis pipeline for multi-allelic data, i.e. data for which there are more than two alleles at a locus. It covers:</p>
<ol style="list-style-type: decimal">
<li>How multi-allelic format differs from bi-allelic format</li>
<li>Binding multi-allelic data to a project and running a basic MCMC</li>
<li>Checking MCMC behaviour</li>
<li>Plotting results</li>
<li>More realistic priors on multi-allelic allele frequencies</li>
</ol>
<p>This tutorial assumes some prior knowledge about MALECOT, so if you are completely new to the program we recommend working through the simpler <a href="https://bobverity.github.io/MALECOT/articles/tutorial-biallelic.html">bi-allelic tutorial</a> first.</p>
<div id="loading-and-running-multi-allelic-data" class="section level2">
<h2 class="hasAnchor">
<a href="#loading-and-running-multi-allelic-data" class="anchor"></a>Loading and running multi-allelic data</h2>
<p>The bi-allelic data format used in previous tutorials cannot be used for multi-allelic data because now we can observe more than just homozygous and heterozygous calls at a locus. Instead, if there are <em>J</em> alleles at a locus then we can observe any subset of these alleles, ranging from just a single allele to all <em>J</em> alleles. MALECOT accommodates this by reading in data in long format.</p>
<p>The easiest way to understand long format is to simulate some multi-allelic data. This can be done using the standard <code><a href="../reference/sim_data.html">sim_data()</a></code> function but with the argument <code>data_format = "multiallelic"</code>. As before, there are many elements that make up this simulated data, including records of the true values used in simulation, but here we are only interested in the “data” element. Here we will draw samples from 5 subpopulations covering a range of mean COIs from 1 to 5. We will assume that we have sequenced the samples at 10 loci, with each locus having 5 possible alleles. Finally, we will assume 10% missing data so we can see what missing data looks like in long format:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">mysim &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_data.html">sim_data</a></span>(<span class="dt">data_format =</span> <span class="st">"multiallelic"</span>, <span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">L =</span> <span class="dv">10</span>, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">COI_mean =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">5</span>,
                  <span class="dt">alleles =</span> <span class="dv">5</span>, <span class="dt">prop_missing =</span> <span class="fl">0.1</span>)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(mysim<span class="op">$</span>data)</code></pre></div>
<pre><code>##   sample_ID locus haplotype
## 1   samp001     1         3
## 2   samp001     2        -9
## 3   samp001     3        -9
## 4   samp001     4         4
## 5   samp001     5         5
## 6   samp001     6         4</code></pre>
<p>We can see that multi-allelic data has three columns, consisting of the sample ID, the locus, and the observed haplotype. The column names must match those shown above. The locus column must contain positive integer values starting at 1, meaning if loci are encoded as character strings then they must be converted to integers first. The same is true for haplotypes, which must be encoded as positive integers starting at 1, or as missing data.</p>
<p>Every locus must be represented in every sample - there can be no missing loci. Instead we can use the missing data character (-9 by default) to insert gaps in the data as needed. For example, in the simulated data above there is missing information in sample001 at loci 2 and 3, but this sample still has entries for all 10 loci rather than leaving these rows out entirely.</p>
<p>Once we have data in the correct format we can create a new project and bind the data to the project using the <code><a href="../reference/bind_data_multiallelic.html">bind_data_multiallelic()</a></code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create project and bind data</span>
myproj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/malecot_project.html">malecot_project</a></span>()
myproj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_data_multiallelic.html">bind_data_multiallelic</a></span>(myproj, <span class="dt">df =</span> mysim<span class="op">$</span>data)</code></pre></div>
<p>We create parameter sets in the usual way, and with the same options for priors as for bi-allelic data. The only difference is that there is currently no error model implemented in the multi-allelic method, meaning arguments like <code>e1</code> and <code>e2</code> are ignored (this is something that may change in future versions of the program). We run the MCMC using the <code><a href="../reference/run_mcmc.html">run_mcmc()</a></code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># create parameter set</span>
myproj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/new_set.html">new_set</a></span>(myproj, <span class="dt">name =</span> <span class="st">"tutorial multiallelic"</span>, <span class="dt">COI_model =</span> <span class="st">"nb"</span>, <span class="dt">COI_max =</span> <span class="dv">20</span>,
                  <span class="dt">estimate_COI_mean =</span> <span class="ot">TRUE</span>, <span class="dt">COI_dispersion =</span> <span class="dv">2</span>, <span class="dt">lambda =</span> <span class="dv">1</span>)

<span class="co"># run MCMC</span>
myproj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_mcmc.html">run_mcmc</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">burnin =</span> <span class="fl">1e4</span>, <span class="dt">converge_test =</span> <span class="fl">1e2</span>,
                   <span class="dt">samples =</span> <span class="fl">1e4</span>, <span class="dt">pb_markdown =</span>  <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Running MCMC for K = 5
## Burn-in phase
## 
  |                                                                       
  |=================================================================| 100%
##    converged within 200 iterations
## Sampling phase
## 
  |                                                                       
  |=================================================================| 100%
##    completed in 10.2614 seconds
## 
## Processing results</code></pre>
<pre><code>## Total run-time: 11.16 seconds</code></pre>
<p>You may find that this MCMC takes considerably longer to run than the bi-allelic MCMC. This is because the likelihood calculation is more complicated when there are more than two alleles.</p>
<p>As always we need to check the behaviour of our MCMC before moving on to results:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_loglike_dignostic.html">plot_loglike_dignostic</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-8-1.png" width="768"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_ESS.html">get_ESS</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>##    rung1 
## 636.3328</code></pre>
<p>Notice that the autocorrelation falls off much more slowly than it did under the bi-allelic MCMC, and hence the effective sample size is smaller. This is one example where we should re-run the MCMC with a larger number of <code>samples</code> to increase the chance that the MCMC has explored the space well. For the sake of this tutorial we will save time by loading in results obtained by re-running this MCMC with <code>samples = 1e5</code>:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># check behaviour</span>
<span class="kw"><a href="../reference/plot_loglike_dignostic.html">plot_loglike_dignostic</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/get_ESS.html">get_ESS</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>)</code></pre></div>
<pre><code>##    rung1 
## 4309.956</code></pre>
<p>We now mave a nice fuzzy black caterpillar and a much larger effective sample size, giving us greater confidence that the MCMC has explored the space well.</p>
</div>
<div id="plotting-results" class="section level2">
<h2 class="hasAnchor">
<a href="#plotting-results" class="anchor"></a>Plotting results</h2>
<div id="structure-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#structure-plots" class="anchor"></a>Structure plots</h3>
<p>The same plotting functions can be used irrespective of whether data is bi-allelic or multi-allelic. In the case of the posterior allocation or “structure” plot we find that there is generally more signal in multi-allelic data because there are more possible ways for subpopulations to look different from one another:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># structure plot</span>
<span class="kw"><a href="../reference/plot_structure.html">plot_structure</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">divide_ind_on =</span> <span class="ot">TRUE</span>)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-11-1.png" width="768"></p>
<p>In this example we find that 100 samples sequenced at just 10 loci with 5 alleles is enough to pull samples apart into 5 distinct subpopulations, while a similar analysis with bi-allelic data would have struggled to detect this level of structure.</p>
</div>
<div id="posterior-coi-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-coi-plots" class="anchor"></a>Posterior COI plots</h3>
<p>Perhaps the main advantage of multi-allelic data is in estimating COIs, where there tends to be far greater power than for bi-allelic data. This is because each new allele brings additional information about the number of circulating strains, rather than just relying on the overall proportion of heterozygous vs. homozygous calls. The following plot shows posterior 95% credible intervals in black, with true (simulated) COIs overlayed as red crosses:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># load ggplot2 package</span>
<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/library">library</a></span>(ggplot2)

<span class="co"># produce plot of posterior COIs</span>
posterior_COI &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_COI.html">plot_COI</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>)

<span class="co"># overlay true COI values</span>
posterior_COI &lt;-<span class="st"> </span>posterior_COI <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> <span class="dv">1</span><span class="op">:</span><span class="dv">100</span>, <span class="dt">y =</span> mysim<span class="op">$</span>true_m), <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">shape =</span> <span class="dv">4</span>)
posterior_COI</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-12-1.png" width="768"></p>
<p>In this example we find that estimates are precise up to COIs of around 3 or 4, then become imprecise at 5 and above. Generally speaking our ability to discern high COIs increases with the number of possible alleles at a locus.</p>
<p>The same gains in precision can be seen in the estimated mean COI per subpopulation:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># get correct plotting order</span>
group_order_k5 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/get_group_order.html">get_group_order</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">target_group =</span> mysim<span class="op">$</span>true_group)
plot_order &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/order">order</a></span>(group_order_k5)

<span class="kw"><a href="../reference/plot_COI_mean.html">plot_COI_mean</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">deme_order =</span> plot_order)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-13-1.png" width="480"></p>
</div>
<div id="posterior-allele-frequency-plots" class="section level3">
<h3 class="hasAnchor">
<a href="#posterior-allele-frequency-plots" class="anchor"></a>Posterior allele frequency plots</h3>
<p>The only plot that differs between bi-allelic and multi-allelic data is the posterior allele frequency plot, which is now a grouped barplot showing posterior 95% credible intervals for each separate allele. The following plot shows posterior allele frequencies for the first deme only, with true values overlayed as red crosses:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="co"># produce plot of posterior allele frequencies for this subpopulation</span>
posterior_p &lt;-<span class="st"> </span><span class="kw"><a href="../reference/plot_p.html">plot_p</a></span>(myproj, <span class="dt">K =</span> <span class="dv">5</span>, <span class="dt">deme =</span> <span class="dv">1</span>)

<span class="co"># get true simulated allele frequencies for this subpopulation</span>
sim_p &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mapply">mapply</a></span>(<span class="cf">function</span>(x){x[group_order_k5[<span class="dv">1</span>], ]}, mysim<span class="op">$</span>true_p, <span class="dt">SIMPLIFY =</span> <span class="ot">FALSE</span>)

<span class="co"># get plotting results into dataframe</span>
df &lt;-<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/data.frame">data.frame</a></span>(<span class="dt">locus =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">10</span>, <span class="dt">each =</span> <span class="dv">5</span>),
                 <span class="dt">p =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unlist">unlist</a></span>(sim_p),
                 <span class="dt">allele =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rep">rep</a></span>(<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>, <span class="dv">10</span>))

<span class="co"># overlay true allele frequencies onto plot</span>
posterior_p &lt;-<span class="st"> </span>posterior_p <span class="op">+</span><span class="st"> </span><span class="kw"><a href="https://ggplot2.tidyverse.org/reference/geom_point.html">geom_point</a></span>(<span class="kw"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span>(<span class="dt">x =</span> locus, <span class="dt">y =</span> p, <span class="dt">group =</span> allele), <span class="dt">data =</span> df,
                                        <span class="dt">position =</span> <span class="kw"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span>(<span class="dt">width =</span> <span class="fl">0.9</span>), <span class="dt">col =</span> <span class="st">"red"</span>, <span class="dt">shape =</span> <span class="dv">4</span>)

posterior_p</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-14-1.png" width="768"></p>
</div>
</div>
<div id="more-realistic-priors-on-allele-frequencies" class="section level2">
<h2 class="hasAnchor">
<a href="#more-realistic-priors-on-allele-frequencies" class="anchor"></a>More realistic priors on allele frequencies</h2>
<p>In the <a href="https://bobverity.github.io/MALECOT/articles/complex-priors.html">previous tutorial</a> we saw how different priors could be used to define skewed allele frequency distributions, and how different prior shapes could be explored using the <code><a href="../reference/plot_prior_p.html">plot_prior_p()</a></code> function. The same is true for multi-allelic data, except now the prior plots look different because the prior is <em>J</em>-dimensional, where <em>J</em> is the number of alleles. In multi-allelic plots the <em>J</em> dimensions are visualised using a <a href="https://en.wikipedia.org/wiki/Parallel_coordinates">parallel coordinates plot</a>, in which axes are displayed parallel to one another rather than perpendicular. The prior distribution is visualised using 1000 random draws from this distribution, corresponding to 1000 simulated trajectories on the plot.</p>
<p>The following example shows a prior skewed in favour of the second allele. The expected allele frequency for allele <em>j</em> is equal to <code>lambda[j]/sum(lambda)</code>, which in this case yields an expectation of 0.375 for the second allele:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_prior_p.html">plot_prior_p</a></span>(<span class="dt">lambda =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>))</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-15-1.png" width="576"></p>
<p>The prior uncertainty is dictated by the magnitude of <code>lambda</code>, with larger values leading to reduced uncertainty. For example, we could define a second prior with exactly the same expected allele frequencies but lower uncertainty by multiplying all <code>lambda</code> values in the above by 10:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_prior_p.html">plot_prior_p</a></span>(<span class="dt">lambda =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>,<span class="dv">6</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)<span class="op">*</span><span class="dv">10</span>)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-16-1.png" width="576"></p>
<p>The default prior in the multi-allelic case is a value of <code>lambda[j] = 1</code> for every allele, giving an expected allele frequency of 1/<em>J</em> for every allele:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/plot_prior_p.html">plot_prior_p</a></span>(<span class="dt">lambda =</span> <span class="dv">1</span>, <span class="dt">alleles =</span> <span class="dv">5</span>)</code></pre></div>
<p><img src="multiallelic-data_files/figure-html/unnamed-chunk-17-1.png" width="576"></p>
<p>When thinking about the prior on allele frequencies it is useful to imagine that each subpopulation has its own allele frequencies, drawn by picking one of these trajectories at random. Therefore if the prior is very precise (like the second plot above) then we are stating that we expect subpopulations to look very similar in their composition. If this seems unlikely <em>a priori</em> then we should use a smaller value of <code>lambda</code>. Our aim when designing priors is to capture the <em>plausible</em> range of values, not what we expect the actual values to be.</p>
<p>The <a href="https://bobverity.github.io/MALECOT/articles/comparing-models.html">next tutorial</a> covers how to compare different values of <span class="math inline">\(K\)</span> and different models in MALECOT.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#loading-and-running-multi-allelic-data">Loading and running multi-allelic data</a></li>
      <li><a href="#plotting-results">Plotting results</a></li>
      <li><a href="#more-realistic-priors-on-allele-frequencies">More realistic priors on allele frequencies</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
