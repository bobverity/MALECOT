<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Basic Tutorial • MALECOT</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><meta property="og:title" content="Basic Tutorial">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">MALECOT</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/basic_tutorial.html">Basic Tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Basic Tutorial</h1>
                        <h4 class="author">Bob Verity</h4>
            
            <h4 class="date">2018-06-13</h4>
      
      
      <div class="hidden name"><code>basic_tutorial.Rmd</code></div>

    </div>

    
    
<p>This vignette demonstrates the use of the MALECOT package on a simple biallelic simulated data set, including installing the package, simulating some data, running the model and performing simple checks on the MCMC output.</p>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<p>MALECOT relies on the Rcpp package, which requires the following OS-specific steps:</p>
<ul>
<li>Windows
<ul>
<li>Download and install the appropriate version of <a href="https://cran.rstudio.com/bin/windows/Rtools/">Rtools</a> for your version of R. On installation, ensure you check the box to arrange your system PATH as recommended by Rtools</li>
</ul>
</li>
<li>Mac OS X
<ul>
<li>Download and install <a href="http://itunes.apple.com/us/app/xcode/id497799835?mt=12">XCode</a>
</li>
<li>Within XCode go to Preferences : Downloads and install the Command Line Tools</li>
</ul>
</li>
<li>Linux (Debian/Ubuntu)
<ul>
<li>
<p>Install the core software development utilities required for R package development as well as LaTeX by executing</p>
<pre><code>```
sudo apt-get install r-base-dev texlive-full
```</code></pre>
</li>
</ul>
</li>
</ul>
<p>Next, in R, ensure that you have the devtools package installed by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">install.packages</span>(<span class="st">"devtools"</span>, <span class="dt">repos=</span><span class="st">'http://cran.us.r-project.org'</span>)</code></pre></div>
<p>Then we can simply install the <em>MALECOT</em> package directly from GitHub by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"bobverity/MALECOT"</span>)</code></pre></div>
<p>Finally, we need to load the package</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(MALECOT)</code></pre></div>
</div>
<div id="simulating-some-data" class="section level2">
<h2 class="hasAnchor">
<a href="#simulating-some-data" class="anchor"></a>Simulating some data</h2>
<p>MALECOT contains basic functions for simulating genetic data. The underlying model used in simulation is identical to that used in the inference step, meaning these simulations can be used to test the power and accuracy of the model in different settings.</p>
<p>We start by simulating a biallelic data set of 100 samples at 24 loci, drawn from 3 distinct subpopulations.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">sim1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/sim_data.html">sim_data</a></span>(<span class="dt">n =</span> <span class="dv">100</span>, <span class="dt">L =</span> <span class="dv">24</span>, <span class="dt">K =</span> <span class="dv">3</span>)</code></pre></div>
<p>If we look inside this object using <code>names(sim1)</code> we will see that, in addition to the raw “data” element, the function returns the <em>true</em> value of the grouping, complexity of infection (m), and allele frequencies (p). These can be used to ground truth our inference, and check that the model is behaving as we expect.</p>
</div>
<div id="basic-analysis" class="section level2">
<h2 class="hasAnchor">
<a href="#basic-analysis" class="anchor"></a>Basic analysis</h2>
<p>The analysis pipeline is built around MALECOT “projects”, similar to the projects used in programs like STRUCTURE. This project will store all data, parameters, and output for a given analysis in one convenient location.</p>
<p>We start by creating a new project, and loading in the simulated data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/malecot_project.html">malecot_project</a></span>()
my_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/bind_data.html">bind_data</a></span>(my_proj, <span class="dt">data =</span> sim1$data)</code></pre></div>
<pre><code>## biallelic format detected</code></pre>
<p>Notice that the <code><a href="../reference/bind_data.html">bind_data()</a></code> function takes a project as input, and returns the modified project as output - this will be the general format for all functions in the pipeline.</p>
<p>Next, we create a new parameter set. There are multiple model parameters that can be defined at this stage - we will use default settings but exploring a range of K (the number of subpopulations) from 1 to 5.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/new_set.html">new_set</a></span>(my_proj, <span class="dt">K =</span> <span class="dv">1</span>:<span class="dv">5</span>)</code></pre></div>
<p>We can now run the main MCMC under these parameter settings. For the sake of this vignette we will use the option <code>silent = TRUE</code>, although in general it is useful to leave this option on to get a running progress update of the MCMC.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">my_proj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/run_mcmc.html">run_mcmc</a></span>(my_proj, <span class="dt">burnin =</span> <span class="fl">1e3</span>, <span class="dt">samples =</span> <span class="fl">1e3</span>, <span class="dt">rungs =</span> <span class="dv">1</span>, <span class="dt">silent =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## Processing results</code></pre>
<p>All output is stored within the <code>my_proj</code> object, and we can now produce plots of the posterior population assignment (i.e. “structure” plots), and the posterior complexity of infection of all samples.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">for (k in <span class="dv">1</span>:<span class="dv">5</span>) {
  <span class="kw"><a href="../reference/plot_q_matrix.html">plot_q_matrix</a></span>(my_proj, <span class="dt">K =</span> k, <span class="dt">main =</span> <span class="kw">paste</span>(<span class="st">"K ="</span>, k))
  <span class="kw"><a href="../reference/plot_m_quantiles.html">plot_m_quantiles</a></span>(my_proj, <span class="dt">K =</span> k)
}</code></pre></div>
<p><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-1.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-2.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-3.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-4.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-5.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-6.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-7.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-8.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-9.png" width="700"><img src="basic_tutorial_files/figure-html/unnamed-chunk-8-10.png" width="700"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#installation">Installation</a></li>
      <li><a href="#simulating-some-data">Simulating some data</a></li>
      <li><a href="#basic-analysis">Basic analysis</a></li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Bob Verity.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  

  </body>
</html>
